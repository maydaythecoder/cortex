#!/bin/bash
# Cortex shorthand syntax checker
# Usage: ./ctxc <example_name> or ./ctxc check <file.ctx>

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
RUST_DIR="$SCRIPT_DIR/rust"

# Check if we're in the right directory
if [ ! -d "$RUST_DIR" ]; then
    echo "Error: rust directory not found. Make sure you're in the cortex project root."
    exit 1
fi

# Change to rust directory
cd "$RUST_DIR"

# If no arguments provided, show help
if [ $# -eq 0 ]; then
    echo "Cortex Syntax Checker"
    echo "===================="
    echo ""
    echo "Usage:"
    echo "  ./ctxc <example_name>     - Check syntax of a specific example"
    echo "  ./ctxc check <file.ctx>   - Check syntax of any .ctx file"
    echo ""
    echo "Available examples:"
    echo "  hello_world"
    echo "  function_demo"
    echo "  arithmetic"
    echo "  simple_algorithms"
    echo "  fibonacci"
    echo "  factorial"
    echo "  prime_numbers"
    echo "  bubble_sort"
    echo "  comprehensive_features"
    echo "  ai_ml_comprehensive"
    echo "  simple_loops"
    echo "  loops"
    echo "  printing"
    echo "  simple_arithmetic"
    echo ""
    echo "Examples:"
    echo "  ./ctxc hello_world"
    echo "  ./ctxc check ../examples/hello_world.ctx"
    exit 0
fi

# Handle different commands
case "$1" in
    "check")
        if [ $# -lt 2 ]; then
            echo "Error: Please provide a file to check"
            echo "Usage: ./ctxc check <file.ctx>"
            exit 1
        fi
        cargo run -- check "$2"
        ;;
    "hello_world")
        cargo run -- check ../examples/hello_world.ctx
        ;;
    "function_demo")
        cargo run -- check ../examples/function_demo.ctx
        ;;
    "arithmetic")
        cargo run -- check ../examples/arithmetic.ctx
        ;;
    "simple_algorithms")
        cargo run -- check ../examples/simple_algorithms.ctx
        ;;
    "fibonacci")
        cargo run -- check ../examples/fibonacci.ctx
        ;;
    "factorial")
        cargo run -- check ../examples/factorial.ctx
        ;;
    "prime_numbers")
        cargo run -- check ../examples/prime_numbers.ctx
        ;;
    "bubble_sort")
        cargo run -- check ../examples/bubble_sort.ctx
        ;;
    "comprehensive_features")
        cargo run -- check ../examples/comprehensive_features.ctx
        ;;
    "ai_ml_comprehensive")
        cargo run -- check ../examples/ai_ml_comprehensive.ctx
        ;;
    "simple_loops")
        cargo run -- check ../examples/simple_loops.ctx
        ;;
    "loops")
        cargo run -- check ../examples/loops.ctx
        ;;
    "printing")
        cargo run -- check ../examples/printing.ctx
        ;;
    "simple_arithmetic")
        cargo run -- check ../examples/simple_arithmetic.ctx
        ;;
    *)
        echo "Error: Unknown example '$1'"
        echo "Run './ctxc' without arguments to see available examples"
        exit 1
        ;;
esac
